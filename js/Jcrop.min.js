/**
 * Jcrop.min.js v2.0.0 (build:20130831)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2013 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
(function(a){var b=function(){this.core=null};a.extend(b.prototype,{tag:"constrain",priority:5,filter:function(a,b){return b=="move"?(a.x<this.minx&&(a.x=this.minx,a.x2=a.w+a.x),a.y<this.miny&&(a.y=this.miny,a.y2=a.h+a.y),a.x2>this.maxx&&(a.x2=this.maxx,a.x=a.x2-a.w),a.y2>this.maxy&&(a.y2=this.maxy,a.y=a.y2-a.h)):(a.x<this.minx&&(a.x=this.minx),a.y<this.miny&&(a.y=this.miny),a.x2>this.maxx&&(a.x2=this.maxx),a.y2>this.maxy&&(a.y2=this.maxy)),a.w=a.x2-a.x,a.h=a.y2-a.y,a},refresh:function(a){this.elw=a.core.container.width(),this.elh=a.core.container.height(),this.minx=0+a.edge.w,this.miny=0+a.edge.n,this.maxx=this.elw+a.edge.e,this.maxy=this.elh+a.edge.s}});var c=function(){this.core=null};a.extend(c.prototype,{tag:"extent",priority:12,offsetFromCorner:function(a,b,c){var d=b[0],e=b[1];switch(a){case"bl":return[c.x2-d,c.y,d,e];case"tl":return[c.x2-d,c.y2-e,d,e];case"br":return[c.x,c.y,d,e];case"tr":return[c.x,c.y2-e,d,e]}},getQuadrant:function(a){var b=a.opposite[0]-a.offsetx,c=a.opposite[1]-a.offsety;return b<0&&
c<0?"br":b>=0&&c>=0?"tl":b<0&&c>=0?"tr":"bl"},filter:function(a,b,c){if(b=="move")return a;var d=a.w,e=a.h,f=c.state,g=this.limits,h=f?this.getQuadrant(f):"br";return g.minw&&d<g.minw&&(d=g.minw),g.minh&&e<g.minh&&(e=g.minh),g.maxw&&d>g.maxw&&(d=g.maxw),g.maxh&&e>g.maxh&&(e=g.maxh),d==a.w&&e==a.h?a:q.wrapFromXywh(this.offsetFromCorner(h,[d,e],a))},refresh:function(a){this.elw=a.core.container.width(),this.elh=a.core.container.height(),this.limits={minw:a.minSize[0],minh:a.minSize[1],maxw:a.maxSize[0],maxh:a.maxSize[1]}}});var d=function(){this.minw=40,this.minh=40,this.maxw=0,this.maxh=0,this.core=null};a.extend(d.prototype,{tag:"backoff",priority:22,filter:function(a){var b=this.bound;return a.x<b.minx&&(a.x=b.minx,a.x2=a.w+a.x),a.y<b.miny&&(a.y=b.miny,a.y2=a.h+a.y),a.x2>b.maxx&&(a.x2=b.maxx,a.x=a.x2-a.w),a.y2>b.maxy&&(a.y2=b.maxy,a.y=a.y2-a.h),a},refresh:function(a){this.elw=a.core.container.width(),this.elh=a.core.container.height(),this.bound={minx:0+a.edge.w,miny:0+a.edge.n,maxx:this.elw+a.edge.e,maxy:this
.elh+a.edge.s}}});var e=function(){this.ratio=0,this.core=null};a.extend(e.prototype,{tag:"ratio",priority:15,offsetFromCorner:function(a,b,c){var d=b[0],e=b[1];switch(a){case"bl":return[c.x2-d,c.y,d,e];case"tl":return[c.x2-d,c.y2-e,d,e];case"br":return[c.x,c.y,d,e];case"tr":return[c.x,c.y2-e,d,e]}},getBoundRatio:function(a,b){var c=q.getLargestBox(this.ratio,a.w,a.h);return q.wrapFromXywh(this.offsetFromCorner(b,c,a))},getQuadrant:function(a){var b=a.opposite[0]-a.offsetx,c=a.opposite[1]-a.offsety;return b<0&&c<0?"br":b>=0&&c>=0?"tl":b<0&&c>=0?"tr":"bl"},filter:function(a,b,c){if(!this.ratio)return a;var d=a.w/a.h,e=c.state,f=e?this.getQuadrant(e):"br";b=b||"se";if(b=="move")return a;switch(b){case"n":a.x2=this.elw,a.w=a.x2-a.x,f="tr";break;case"s":a.x2=this.elw,a.w=a.x2-a.x,f="br";break;case"e":a.y2=this.elh,a.h=a.y2-a.y,f="br";break;case"w":a.y2=this.elh,a.h=a.y2-a.y,f="bl"}return this.getBoundRatio(a,f)},refresh:function(a){this.ratio=a.aspectRatio,this.elw=a.core.container.width(),this.elh=a.core.container
.height()}});var f=function(){this.core=null};a.extend(f.prototype,{tag:"round",priority:90,filter:function(a){var b={x:Math.round(a.x),y:Math.round(a.y),x2:Math.round(a.x2),y2:Math.round(a.y2)};return b.w=b.x2-b.x,b.h=b.y2-b.y,b}});var g=function(a,b){this.color=b||"black",this.opacity=a||.5,this.core=null,this.shades={}};a.extend(g.prototype,{tag:"shader",fade:!0,fadeEasing:"swing",fadeSpeed:320,priority:95,init:function(){var b=this;b.attached||(b.visible=!1,b.container=a("<div />").addClass(b.core.opt.cssclass.shades).prependTo(this.core.container).hide(),b.elh=this.core.container.height(),b.elw=this.core.container.width(),b.shades={top:b.createShade(),right:b.createShade(),left:b.createShade(),bottom:b.createShade()},b.attached=!0)},destroy:function(){this.container.remove()},setColor:function(b,c){var d=this;if(b==d.color)return d;this.color=b;var e=q.supportsColorFade();return a.each(d.shades,function(a,f){!d.fade||c||!e?f.css("backgroundColor",b):f.animate({backgroundColor:b},{queue:!1,duration:d.fadeSpeed
,easing:d.fadeEasing})}),d},setOpacity:function(b,c){var d=this;return b==d.opacity?d:(d.opacity=b,a.each(d.shades,function(a,e){!d.fade||c?e.css({opacity:b}):e.animate({opacity:b},{queue:!1,duration:d.fadeSpeed,easing:d.fadeEasing})}),d)},createShade:function(){return a("<div />").css({position:"absolute",backgroundColor:this.color,opacity:this.opacity}).appendTo(this.container)},refresh:function(a){var b=this.core,c=this.shades;this.setColor(a.bgColor?a.bgColor:this.core.opt.bgColor),this.setOpacity(a.bgOpacity?a.bgOpacity:this.core.opt.bgOpacity),this.elh=b.container.height(),this.elw=b.container.width(),c.right.css("height",this.elh+"px"),c.left.css("height",this.elh+"px")},filter:function(a,b,c){if(!c.active)return a;var d=this,e=d.shades;return e.top.css({left:Math.round(a.x)+"px",width:Math.round(a.w)+"px",height:Math.round(a.y)+"px"}),e.bottom.css({top:Math.round(a.y2)+"px",left:Math.round(a.x)+"px",width:Math.round(a.w)+"px",height:d.elh-Math.round(a.y2)+"px"}),e.right.css({left:Math.round(a.x2)+"px",
width:d.elw-Math.round(a.x2)+"px"}),e.left.css({width:Math.round(a.x)+"px"}),d.visible||(d.container.show(),d.visible=!0),a}});var h=function(){this.stepx=1,this.stepy=1,this.core=null};a.extend(h.prototype,{tag:"grid",priority:19,filter:function(a){var b={x:Math.round(a.x/this.stepx)*this.stepx,y:Math.round(a.y/this.stepy)*this.stepy,x2:Math.round(a.x2/this.stepx)*this.stepx,y2:Math.round(a.y2/this.stepy)*this.stepy};return b.w=b.x2-b.x,b.h=b.y2-b.y,b}});var i=function(b,c,d){var e=this;e.x=b.pageX,e.y=b.pageY,e.selection=c,e.eventTarget=c.core.opt.dragEventTarget,e.orig=c.get(),c.callFilterFunction("refresh");var f=c.core.container.position();e.elx=f.left,e.ely=f.top,e.offsetx=0,e.offsety=0,e.ord=d,e.opposite=e.getOppositeCornerOffset(),a(e.eventTarget).on("mousemove.jcrop",e.createDragHandler()).on("mouseup.jcrop",e.createStopHandler())};a.extend(i.prototype,{getOppositeCornerOffset:function(){var a=this.orig,b=this.x-this.elx-a.x,c=this.y-this.ely-a.y;switch(this.ord){case"nw":case"w":return[a.w-b,a.h-c];case"sw"
:return[a.w-b,-c];case"se":case"s":case"e":return[-b,-c];case"ne":case"n":return[-b,a.h-c]}return[null,null]},dragEvent:function(a){this.offsetx=a.pageX-this.x,this.offsety=a.pageY-this.y,this.selection.update(this.getBox(),this.ord)},endDragEvent:function(a){var b=this.selection;b.element.trigger("cropend",[b,b.get()])},createStopHandler:function(){var b=this;return function(c){return a(b.eventTarget).off(".jcrop"),b.endDragEvent(c),!1}},createDragHandler:function(){var a=this;return function(b){return a.dragEvent(b),!1}},update:function(a,b){var c=this;c.offsetx=a-c.x,c.offsety=b-c.y},resultWrap:function(a){var b={x:Math.min(a[0],a[2]),y:Math.min(a[1],a[3]),x2:Math.max(a[0],a[2]),y2:Math.max(a[1],a[3])};return b.w=b.x2-b.x,b.h=b.y2-b.y,b},getBox:function(){var a=this,b=a.orig,c={x2:b.x+b.w,y2:b.y+b.h};switch(a.ord){case"n":return a.resultWrap([b.x,a.offsety+b.y,c.x2,c.y2]);case"s":return a.resultWrap([b.x,b.y,c.x2,a.offsety+c.y2]);case"e":return a.resultWrap([b.x,b.y,a.offsetx+c.x2,c.y2]);case"w":return a.resultWrap
([b.x+a.offsetx,b.y,c.x2,c.y2]);case"sw":return a.resultWrap([a.offsetx+b.x,b.y,c.x2,a.offsety+c.y2]);case"se":return a.resultWrap([b.x,b.y,a.offsetx+c.x2,a.offsety+c.y2]);case"ne":return a.resultWrap([b.x,a.offsety+b.y,a.offsetx+c.x2,c.y2]);case"nw":return a.resultWrap([a.offsetx+b.x,a.offsety+b.y,c.x2,c.y2]);case"move":return c.nx=b.x+a.offsetx,c.ny=b.y+a.offsety,a.resultWrap([c.nx,c.ny,c.nx+b.w,c.ny+b.h])}}});var j=function(a){this.selection=a,this.core=a.core};a.extend(j.prototype,{getElement:function(){var b=this.selection.get();return a("<div />").css({position:"absolute",top:b.y+"px",left:b.x+"px",width:b.w+"px",height:b.h+"px"})},animate:function(a,b,c,d,e){var f=this;f.selection.allowResize(!1),f.getElement().animate({top:b+"px",left:a+"px",width:c+"px",height:d+"px"},{easing:f.core.opt.animEasing,duration:f.core.opt.animDuration,complete:function(){f.selection.allowResize(!0),e&&e.call(this)},progress:function(a){var b={},c,d=a.tweens;for(c=0;c<d.length;c++)b[d[c].prop]=d[c].now;var e={x:parseInt(b.left
),y:parseInt(b.top),w:parseInt(b.width),h:parseInt(b.height)};e.x2=e.x+e.w,e.y2=e.y+e.h,f.selection.update(e,"se")}})}});var k=function(a){this.core=a,this.init()};k.defaults={passthru:[9],debug:!1},a.extend(k.prototype,{init:function(){a.extend(this,k.defaults),this.enable()},disable:function(){this.core.container.off("keydown.jcrop")},enable:function(){var b=this,c=b.core;c.container.on("keydown.jcrop",function(d){var e=d.shiftKey?16:2;if(a.inArray(d.keyCode,b.passthru)>=0)return!0;switch(d.keyCode){case 37:c.nudge(-e,0);break;case 38:c.nudge(0,-e);break;case 39:c.nudge(e,0);break;case 40:c.nudge(0,e);break;case 46:case 8:return c.requestDelete(),!1;default:b.debug&&console.log("keycode: "+d.keyCode)}!d.metaKey&&!d.ctrlKey&&d.preventDefault()})}});var l=function(b,c){a.extend(this,l.defaults,c||{}),this.manager=b,this.core=b.core};l.defaults={offset:[-8,-8],active:!0,minsize:[20,20]},a.extend(l.prototype,{start:function(b){var c=this.core;if(!c.opt.allowSelect)return!1;if(c.opt.multi&&c.opt.multiMax&&c.ui.multi
.length>=c.opt.multiMax)return!1;var d=a(b.currentTarget).offset(),e=b.pageX-d.left+this.offset[0],f=b.pageY-d.top+this.offset[1],g=c.ui.multi;if(!c.opt.multi)if(c.opt.multiCleanup){for(var h=0;h<g.length;h++)g[h].remove();c.ui.multi=[]}else c.removeSelection(c.ui.selection);var i=c.newSelection().update(q.wrapFromXywh([e,f,1,1]));return i.startDrag(b,"se")},end:function(a,b){this.drag(a,b);var c=this.sel.get();c.w<this.minsize[0]||c.h<this.minsize[1]?this.core.requestDelete():this.sel.focus()}});var m=function(a){this.core=a,this.ui=a.ui,this.init()};a.extend(m.prototype,{init:function(){this.setupEvents(),this.dragger=new l(this)},tellConfigUpdate:function(a,b){for(var c=0,d=this.ui.multi,e=d.length;c<e;c++)d[c].setOptions&&(d[c].linked||this.core.opt.linkCurrent&&d[c]==this.ui.selection)&&d[c].setOptions(a)},configUpdateHandler:function(){var a=this;return function(b,c,d,e){a.tellConfigUpdate(d,e)}},startDragHandler:function(){var a=this;return function(b){return a.dragger.start(b)}},removeEvents:function()
{this.core.container.off(".jcrop-stage")},setupEvents:function(){this.core.container.on("mousedown.jcrop.jcrop-stage",this.startDragHandler()),this.core.container.on("cropconfig.jcrop-stage",this.configUpdateHandler())}});var o=function(){};a.extend(o,{defaults:{minSize:[8,8],maxSize:[0,0],aspectRatio:0,edge:{n:0,s:0,e:0,w:0},bgColor:null,bgOpacity:null,last:null,state:null,active:!0,linked:!0,canDelete:!0,canDrag:!0,canResize:!0,canSelect:!0},prototype:{init:function(a){this.core=a,this.startup(),this.linked=this.core.opt.linked,this.attach(),this.element.trigger("cropcreate",this),this.setOptions(this.core.opt),this.element.trigger("cropstart",[this,this.get()])},attach:function(){},startup:function(){var b=this,c=b.core.opt.cssclass;a.extend(b,o.defaults),b.filter=b.core.getDefaultFilters(),b.element=a("<div />").addClass(c.selection).data({selection:b}),b.frame=a("<button />").addClass(c.button).data("ord","move"),b.element.append(b.frame).appendTo(b.core.container),b.core.opt.is_msie&&b.frame.css({opacity
:0,backgroundColor:"white"}),b.insertElements(),b.frame.on("focus.jcrop",function(a){b.element.trigger("cropfocus",b),b.core.setSelection(b),b.element.addClass("jcrop-focus")}).on("blur.jcrop",function(a){b.element.removeClass("jcrop-focus"),b.element.trigger("cropblur",b)})},propagate:["canDelete","canDrag","canResize","canSelect","minSize","maxSize","aspectRatio","edge"],setOptions:function(a){return q.propagate(this.propagate,a,this),this.refresh(),this},refresh:function(){this.allowResize(),this.allowDrag(),this.allowSelect(),this.callFilterFunction("refresh"),this.update(this.get(),"se")},callFilterFunction:function(a,b){for(var c=0;c<this.filter.length;c++)this.filter[c][a]&&this.filter[c][a](this);return this},addFilter:function(a){a.core=this.core,this.hasFilter(a)||(this.filter.push(a),this.sortFilters(),a.init&&a.init(),this.refresh())},hasFilter:function(a){var b,c=this.filter,d=[];for(b=0;b<c.length;b++)if(c[b]===a)return!0},sortFilters:function(){this.filter.sort(function(a,b){return a.priority-b.
priority})},clearFilters:function(){var a,b=this.filter;for(var a=0;a<b.length;a++)b[a].destroy&&b[a].destroy();this.filter=[]},removeFilter:function(a){var b,c=this.filter,d=[];for(var b=0;b<c.length;b++)c[b].tag&&c[b].tag==a||a===c[b]?c[b].destroy&&c[b].destroy():d.push(c[b]);this.filter=d},runFilters:function(a,b){for(var c=0;c<this.filter.length;c++)a=this.filter[c].filter(a,b,this);return a},endDrag:function(){this.state&&(a(document.body).off(".jcrop"),this.focus(),this.state=null)},startDrag:function(b,c){var d=this,e=d.core;return c=c||a(b.target).data("ord"),this.focus(),c=="move"&&d.element.hasClass(d.core.opt.cssclass.nodrag)?!1:(this.state=new q.component.DragState(b,this,c),!1)},allowSelect:function(a){return a===undefined&&(a=this.canSelect),a&&this.canSelect?this.frame.attr("disabled",!1):this.frame.attr("disabled","disabled"),this},allowDrag:function(a){var b=this,c=b.core.opt.cssclass;return a==undefined&&(a=b.canDrag),a&&b.canDrag?b.element.removeClass(c.nodrag):b.element.addClass(c.nodrag),this
},allowResize:function(a){var b=this,c=b.core.opt.cssclass;return a==undefined&&(a=b.canResize),a&&b.canResize?b.element.removeClass(c.noresize):b.element.addClass(c.noresize),this},remove:function(){this.element.trigger("cropremove",this),this.element.remove()},toBack:function(){this.active=!1,this.element.removeClass("jcrop-current").removeClass("jcrop-focus").css({zIndex:20})},toFront:function(){this.active=!0,this.element.addClass("jcrop-current").css({zIndex:30}),this.callFilterFunction("refresh"),this.refresh()},update:function(a,b){return a=this.runFilters(a,b),this.moveTo(a.x,a.y),this.resize(a.w,a.h),this.last=a,this.element.trigger("cropmove",[this,a]),this},animateTo:function(a,b){var c=new q.component.Animator(this);c.animate(a[0],a[1],a[2],a[3],b)},center:function(a){var b=this.get(),c=this.core,d=c.container.width(),e=c.container.height(),f=[(d-b.w)/2,(e-b.h)/2,b.w,b.h];return this[a?"setSelect":"animateTo"](f)},createElement:function(b,c){return a("<div />").addClass(b+" ord-"+c).data("ord",c)},
moveTo:function(a,b){this.element.css({top:b+"px",left:a+"px"})},blur:function(){return this.element.blur(),this},focus:function(){return this.core.setSelection(this),this.frame.focus(),this},resize:function(a,b){this.element.css({width:a+"px",height:b+"px"})},get:function(){var a=this.element,b=a.position(),c=a.width(),d=a.height(),e={x:b.left,y:b.top};return e.x2=e.x+c,e.y2=e.y+d,e.w=c,e.h=d,e},insertElements:function(){var a=this,b,c=a.core,d=a.element,e=a.core.opt,f=e.borders,g=e.handles,h=e.dragbars;for(b=0;b<f.length;b++)d.append(a.createElement(e.cssclass.borders,f[b]));for(b=0;b<h.length;b++)d.append(a.createElement(e.cssclass.dragbars,h[b]));for(b=0;b<g.length;b++)d.append(a.createElement(e.cssclass.handles,g[b]))}}});var p=function(a,b,c){this.src=a,b||(b=new Image),this.element=b,this.callback=c,this.load()};a.extend(p,{attach:function(a,b){return new p(a.src,a,b)},prototype:{getDimensions:function(){var a=this.element;return a.naturalWidth?[a.naturalWidth,a.naturalHeight]:a.width?[a.width,a.height]
:null},fireCallback:function(){this.element.onload=null,typeof this.callback=="function"&&this.callback.apply(this,this.getDimensions())},isLoaded:function(){return this.element.complete},load:function(){var a=this,b=a.element;b.src=a.src,a.isLoaded()?a.fireCallback():a.element.onload=function(b){a.fireCallback()}}}});var q=function(b,c){var d=navigator.userAgent.toLowerCase();this.opt=a.extend(!0,{},q.defaults),this.container=a(b),this.opt.is_msie=/msie/.test(d),this.opt.is_ie6=/msie [1-6]\./.test(d),this.container.addClass(this.opt.cssclass.container),this.ui={},this.state=null,this.ui.multi=[],this.ui.selection=null,this.filter={},this.init(),this.setOptions(c),/msie [1-8]\./.test(d)&&(this.opt.dragEventTarget=document.body)};q.component={ImageLoader:p,DragState:i,StageManager:m,Animator:j,Selection:o,Keyboard:k},a.extend(q,{defaults:{edge:{n:0,s:0,e:0,w:0},setSelect:null,linked:!0,linkCurrent:!0,canDelete:!0,canSelect:!0,canDrag:!0,canResize:!0,keyboardComponent:q.component.Keyboard,dragstateComponent:q.component
.DragState,stagemanagerComponent:q.component.StageManager,animatorComponent:q.component.Animator,selectionComponent:q.component.Selection,allowSelect:!0,multi:!1,multiMax:!1,multiCleanup:!0,animation:!0,animEasing:"swing",animDuration:400,fading:!0,fadeDuration:300,fadeEasing:"swing",bgColor:"black",bgOpacity:.5,applyFilters:["constrain","extent","backoff","ratio","shader","round"],borders:["n","s","e","w"],handles:["n","s","e","w","sw","ne","nw","se"],dragbars:["n","e","w","s"],dragEventTarget:window,cssclass:{container:"jcrop-active",shades:"jcrop-shades",selection:"jcrop-selection",borders:"jcrop-border",handles:"jcrop-handle jcrop-drag",button:"jcrop-box jcrop-drag",drag:"jcrop-drag",nodrag:"jcrop-nodrag",noresize:"jcrop-noresize",dragbars:"jcrop-dragbar jcrop-drag"}},filter:{constrain:b,extent:c,grid:h,backoff:d,shader:g,ratio:e,round:f},attach:function(b,c){var d=new a.Jcrop(b,c);return d},supportsCanvas:function(){var a=document.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},imgCopy
:function(a){var b=new Image;return b.src=a.src,b},imageClone:function(a){return q.supportsCanvas()?q.canvasClone(a):q.imgCopy(a)},canvasClone:function(b){var c=document.createElement("canvas"),d=a(c).width(b.width).height(b.height),e=c.getContext("2d");return c.width=b.naturalWidth,c.height=b.naturalHeight,e.drawImage(b,0,0),d},propagate:function(a,b,c){for(var d=0,e=a.length;d<e;d++)b.hasOwnProperty(a[d])&&(c[a[d]]=b[a[d]])},getLargestBox:function(a,b,c){return b/c>a?[c*a,c]:[b,b/a]},supportsColorFade:function(){return a.fx.step.hasOwnProperty("backgroundColor")},wrapFromXywh:function(a){var b={x:a[0],y:a[1],w:a[2],h:a[3]};return b.x2=b.x+b.w,b.y2=b.y+b.h,b}}),a.extend(q.prototype,{init:function(){this.ui.keyboard=new this.opt.keyboardComponent(this),this.ui.stage=new this.opt.stagemanagerComponent(this),this.applyFilters(),this.initEvents(),this.container.trigger("cropinit",this)},setOptions:function(b,c){return a.isPlainObject(b)||(b={}),a.extend(this.opt,b),this.opt.setSelect&&(this.ui.multi.length||this.
newSelection(),this.ui.multi[0].update(q.wrapFromXywh(this.opt.setSelect)),this.opt.setSelect=null),this.container.trigger("cropconfig",[this,b,c]),this},destroy:function(){this.opt.imgTarget?(this.container.before(this.opt.imgTarget),this.container.remove(),a(this.opt.imgTarget).removeData("Jcrop")):this.container.remove()},applyFilters:function(){var b;for(var c=0,d=this.opt.applyFilters,e=d.length;c<e;c++)a.Jcrop.filter[d[c]]&&(b=new a.Jcrop.filter[d[c]]),b.core=this,b.init&&b.init(),this.filter[d[c]]=b},getDefaultFilters:function(){var b=[];return a.each(this.filter,function(a,c){b.push(c)}),b.sort(function(a,b){return a.priority-b.priority}),b},setSelection:function(a){var b=this.ui.multi,c=[];for(var d=0;d<b.length;d++)b[d]!==a&&c.push(b[d]),b[d].toBack();return c.unshift(a),this.ui.multi=c,this.ui.selection=a,a.toFront(),a},getSelection:function(a){var b=this.ui.selection.get();return b},newSelection:function(a){return a||(a=new this.opt.selectionComponent),a.init(this),this.setSelection(a),a},hasSelection
:function(a){for(var b=0;b<this.ui.multi;b++)if(a===this.ui.multi[b])return!0},removeSelection:function(a){var b,c=[],d=this.ui.multi;for(var b=0;b<d.length;b++)a!==d[b]?c.push(d[b]):d[b].remove();return this.ui.multi=c},addFilter:function(a){for(var b=0,c=this.ui.multi,d=c.length;b<d;b++)c[b].addFilter(a);return this},removeFilter:function(a){for(var b=0,c=this.ui.multi,d=c.length;b<d;b++)c[b].removeFilter(a);return this},blur:function(){return this.ui.selection.blur(),this},focus:function(){return this.ui.selection.focus(),this},initEvents:function(){var a=this;a.container.on("selectstart",function(a){return!1}).on("mousedown","."+a.opt.cssclass.drag,a.startDrag())},maxSelect:function(){this.setSelect([0,0,this.elw,this.elh])},nudge:function(a,b){var c=this.ui.selection,d=c.get();d.x+=a,d.x2+=a,d.y+=b,d.y2+=b,d.x<0?(d.x2=d.w,d.x=0):d.x2>this.elw&&(d.x2=this.elw,d.x=d.x2-d.w),d.y<0?(d.y2=d.h,d.y=0):d.y2>this.elh&&(d.y2=this.elh,d.y=d.y2-d.h),c.element.trigger("cropstart",[c,d]),c.update(d,"move"),c.element.trigger
("cropend",[c,d])},refresh:function(){for(var a=0,b=this.ui.multi,c=b.length;a<c;a++)b[a].refresh()},blurAll:function(){var a=this.ui.multi;for(var b=0;b<a.length;b++)a[b]!==sel&&n.push(a[b]),a[b].toBack()},requestDelete:function(){if(this.ui.multi.length>1&&this.ui.selection.canDelete)return this.deleteSelection()},deleteSelection:function(){this.removeSelection(this.ui.selection),this.ui.multi[0].focus(),this.ui.selection.refresh()},animateTo:function(a){return this.ui.selection.animateTo(a),this},setSelect:function(a){return this.ui.selection.update(q.wrapFromXywh(a)),this},startDrag:function(){var b=this;return function(c){var d=a(c.target),e=d.closest("."+b.opt.cssclass.selection).data("selection"),f=d.data("ord");return b.container.trigger("cropstart",e),e.startDrag(c,f),!1}},resizeContainer:function(a,b){this.container.width(a).height(b),this.refresh()},setImage:function(b,c){var d=this;if(!d.opt.imgTarget)return!1;new a.Jcrop.component.ImageLoader(b,null,function(b,e){d.resizeContainer(b,e),a(d.opt.imgTarget
).before(this.element).remove(),d.opt.imgTarget=this.element,typeof c=="function"&&c.call(d,b,e)})},update:function(a){this.ui.selection.update(a)}}),a.fn.Jcrop=function(b,c){var d=this.eq(0).data("Jcrop"),e=Array.prototype.slice.call(arguments);if(b=="api")return d;typeof b=="string"&&(e.shift(),d[b]&&d[b].apply(d,e)),this.each(function(){var d=this,e=a(this),f=e.data("Jcrop"),g;return f?f.setOptions(b):this.tagName=="IMG"?a.Jcrop.component.ImageLoader.attach(this,function(f,h){var i=e.wrap("<div />").parent();i.width(f).height(h),g=a.Jcrop.attach(i,a.extend({},b,{imgTarget:d})),e.data("Jcrop",g),typeof c=="function"&&c.call(g)}):(g=a.Jcrop.attach(this,b),e.data("Jcrop",g),typeof c=="function"&&c.call(g)),this})},a.Jcrop=q})(jQuery);