/**
 * jquery.Jcrop.min.js v0.9.10 (build:20130116)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2012 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
(function(a){a.Jcrop=function(b,c){function g(a){return Math.round(a)+"px"}function h(a){return d.baseClass+"-"+a}function i(){return a.fx.step.hasOwnProperty("backgroundColor")}function j(b){var c=a(b).offset();return[c.left,c.top]}function k(a){return[a.pageX-e[0],a.pageY-e[1]]}function l(b){typeof b!="object"&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){typeof d[b]!="function"&&(d[b]=function(){})})}function m(a,b,c){e=j(B),ba.setCursor(a==="move"?a:a+"-resize");if(a==="move")return ba.activateHandlers(o(b),t,c);var d=Y.getFixed(),f=p(a),g=Y.getCorner(p(f));Y.setPressed(Y.getCorner(f)),Y.setCurrent(g),ba.activateHandlers(n(a,d),t,c)}function n(a,b){return function(c){if(!d.aspectRatio)switch(a){case"e":c[1]=b.y2;break;case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}else switch(a){case"e":c[1]=b.y+1;break;case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}Y.setCurrent(c),_.update()}}function o(a){var b=a;return bb.watchKeys(
),function(a){Y.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,_.update()}}function p(a){switch(a){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function q(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=j(B),U=!0,m(a,k(b)),b.stopPropagation(),b.preventDefault(),!1)}}function r(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),R=a.width()/d,S=a.height()/e,a.width(d).height(e)}function s(a){return{x:a.x*R,y:a.y*S,x2:a.x2*R,y2:a.y2*S,w:a.w*R,h:a.h*S}}function t(a){var b=Y.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(_.enableHandles(),_.done()):_.release(),ba.setCursor(d.allowSelect?"crosshair":"default")}function u(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;U=!0,e=j(B),_.disableHandles(),ba.setCursor("crosshair");var b=k(a);return Y.setPressed(b),_.update(),ba.activateHandlers(v,t,a.type.substring(0,5)==="touch"
),bb.watchKeys(),a.stopPropagation(),a.preventDefault(),!1}function v(a){Y.setCurrent(a),_.update()}function w(){var b=a("<div></div>").addClass(h("tracker"));return is_msie&&b.css({opacity:0,backgroundColor:"white"}),b}function bc(a){E.removeClass().addClass(h("holder")).addClass(a)}function bd(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/R,e=a[1]/S,f=a[2]/R,g=a[3]/S;if(V)return;var h=Y.flipCoords(c,e,f,g),i=Y.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;c=k[0],e=k[1],f=k[2],g=k[3],_.animMode(!0);var s,u=function(){return function(){q+=(100-q)/r,k[0]=Math.round(c+q/100*m),k[1]=Math.round(e+q/100*n),k[2]=Math.round(f+q/100*o),k[3]=Math.round(g+q/100*p),q>=99.8&&(q=100),q<100?(bf(k),t()):(_.done(),_.animMode(!1),typeof b=="function"&&b.call(bq))}}();t()}function be(a){bf([a[0]/R,a[1]/S,a[2]/R,a[3]/S]),d.onSelect.call(bq,s(Y.getFixed())),_.enableHandles()}function bf(a){Y.setPressed([a[0],a[1]]),Y.setCurrent([a[2],a[3]]),_.update
()}function bg(){return s(Y.getFixed())}function bh(){return Y.getFixed()}function bi(a){l(a),bp()}function bj(){d.disabled=!0,_.disableHandles(),_.setCursor("default"),ba.setCursor("default")}function bk(){d.disabled=!1,bp()}function bl(){_.done(),ba.activateHandlers(null,null)}function bm(){E.remove(),y.show(),y.css("visibility","visible"),a(b).removeData("Jcrop")}function bn(a,b){_.release(),bj();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;B.width(e).height(f),B.attr("src",a),F.attr("src",a),r(B,g,h),C=B.width(),D=B.height(),F.width(C).height(D),K.width(C+J*2).height(D+J*2),E.width(C).height(D),Z.resize(C,D),bk(),typeof b=="function"&&b.call(bq)},c.src=a}function bo(a,b,c){var e=b||d.bgColor;d.bgFade&&i()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function bp(a){d.allowResize?a?_.enableOnly():_.enableHandles():_.disableHandles(),ba.setCursor(d.allowSelect?"crosshair":"default"),_.setCursor(d.allowMove?"move"
:"default"),d.hasOwnProperty("trueSize")&&(R=d.trueSize[0]/C,S=d.trueSize[1]/D),d.hasOwnProperty("setSelect")&&(be(d.setSelect),_.done(),delete d.setSelect),Z.refresh(),d.bgColor!=L&&(bo(d.shade?Z.getShades():E,d.shade?d.shadeColor||d.bgColor:d.bgColor),L=d.bgColor),M!=d.bgOpacity&&(M=d.bgOpacity,d.shade?Z.refresh():_.setBgOpacity(M)),N=d.maxSize[0]||0,O=d.maxSize[1]||0,P=d.minSize[0]||0,Q=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(B.attr("src",d.outerImage),delete d.outerImage),_.refresh()}var d=a.extend({},a.Jcrop.defaults),e,f;_ua=navigator.userAgent.toLowerCase(),is_msie=/msie/.test(_ua),ie6mode=/msie [1-6]\./.test(_ua),typeof b!="object"&&(b=a(b)[0]),typeof c!="object"&&(c={}),l(c);var x={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},y=a(b),z=!0;if(b.tagName=="IMG"){if(y[0].width!=0&&y[0].height!=0)y.width(y[0].width),y.height(y[0].height);else{var A=new Image;A.src=y[0].src,y.width(A.width),y.height(A.height)}var B=y.clone().removeAttr("id").css(x).show();B
.width(y.width()),B.height(y.height()),y.after(B).hide()}else B=y.css(x).show(),z=!1,d.shade===null&&(d.shade=!0);r(B,d.boxWidth,d.boxHeight);var C=B.width(),D=B.height(),E=a("<div />").width(C).height(D).addClass(h("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(y).append(B);d.addClass&&E.addClass(d.addClass);var F=a("<div />"),G=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),H=a("<div />").width("100%").height("100%").css("zIndex",320),I=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=Y.getFixed();d.onDblClick.call(bq,a)}).insertBefore(B).append(G,H);z&&(F=a("<img />").attr("src",B.attr("src")).css(x).width(C).height(D),G.append(F)),ie6mode&&I.css({overflowY:"hidden"});var J=d.boundary,K=w().width(C+J*2).height(D+J*2).css({position:"absolute",top:g(-J),left:g(-J),zIndex:290}).mousedown(u),L=d.bgColor,M=d.bgOpacity,N,O,P,Q,R,S,T=!0,U,V,W;e=j(B);var X=function(){function a(){var a={},b=["touchstart","touchmove"
,"touchend"],c=document.createElement("div"),d;try{for(d=0;d<b.length;d++){var e=b[d];e="on"+e;var f=e in c;f||(c.setAttribute(e,"return;"),f=typeof c[e]=="function"),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}function b(){return d.touchSupport===!0||d.touchSupport===!1?d.touchSupport:a()}return{createDragger:function(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=j(B),U=!0,m(a,k(X.cfilter(b)),!0),b.stopPropagation(),b.preventDefault(),!1)}},newSelection:function(a){return u(X.cfilter(a))},cfilter:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a},isSupported:a,support:b()}}(),Y=function(){function h(d){d=n(d),c=a=d[0],e=b=d[1]}function i(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]}function j(){return[f,g]}function k(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),D<e+g&&(g+=D-(e+g)),C<c+f&&(f+=C-(c+f)),a+=f,c+=f,b+=g,e+=g}function l(a){var b=m();switch(a){case"ne":return[b.x2,b.y];case"nw"
:return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}}function m(){if(!d.aspectRatio)return p();var f=d.aspectRatio,g=d.minSize[0]/R,h=d.maxSize[0]/R,i=d.maxSize[1]/S,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k),n=l/m,r,s,t,u;return h===0&&(h=C*10),i===0&&(i=D*10),n<f?(s=e,t=m*f,r=j<0?a-t:t+a,r<0?(r=0,u=Math.abs((r-a)/f),s=k<0?b-u:u+b):r>C&&(r=C,u=Math.abs((r-a)/f),s=k<0?b-u:u+b)):(r=c,u=l/f,s=k<0?b-u:b+u,s<0?(s=0,t=Math.abs((s-b)*f),r=j<0?a-t:t+a):s>D&&(s=D,t=Math.abs(s-b)*f,r=j<0?a-t:t+a)),r>a?(r-a<g?r=a+g:r-a>h&&(r=a+h),s>b?s=b+(r-a)/f:s=b-(r-a)/f):r<a&&(a-r<g?r=a-g:a-r>h&&(r=a-h),s>b?s=b+(a-r)/f:s=b-(a-r)/f),r<0?(a-=r,r=0):r>C&&(a-=r-C,r=C),s<0?(b-=s,s=0):s>D&&(b-=s-D,s=D),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>C&&(a[0]=C),a[1]>D&&(a[1]=D),[Math.round(a[0]),Math.round(a[1])]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return c<a&&(e=c,f=a),d<b&&(g=d,h=b),[e,g,f,h]}function p(){var d=c-a,f=e-b,g;return N&&Math.abs(d)>N&&(c=d>0?a+N:a-N),O&&Math.abs(f)>O&&(e=f>0?b+O:
b-O),Q/S&&Math.abs(f)<Q/S&&(e=f>0?b+Q/S:b-Q/S),P/R&&Math.abs(d)<P/R&&(c=d>0?a+P/R:a-P/R),a<0&&(c-=a,a-=a),b<0&&(e-=b,b-=b),c<0&&(a-=c,c-=c),e<0&&(b-=e,e-=e),c>C&&(g=c-C,a-=g,c-=g),e>D&&(g=e-D,b-=g,e-=g),a>C&&(g=a-D,e-=g,b-=g),b>D&&(g=b-D,e-=g,b-=g),q(o(a,b,c,e))}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var a=0,b=0,c=0,e=0,f,g;return{flipCoords:o,setPressed:h,setCurrent:i,getOffset:j,moveOffset:k,getCorner:l,getFixed:m}}(),Z=function(){function f(a,b){e.left.css({height:g(b)}),e.right.css({height:g(b)})}function h(){return i(Y.getFixed())}function i(a){e.top.css({left:g(a.x),width:g(a.w),height:g(a.y)}),e.bottom.css({top:g(a.y2),left:g(a.x),width:g(a.w),height:g(D-a.y2)}),e.right.css({left:g(a.x2),width:g(C-a.x2)}),e.left.css({width:g(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(B),h(),_.setBgOpacity(1,0,1),F.hide(),l(d.shadeColor||d.bgColor,1),_.isAwake()?n(d.bgOpacity
,1):n(1,1))}function l(a,b){bo(p(),a,b)}function m(){b&&(c.remove(),F.show(),b=!1,_.isAwake()?_.setBgOpacity(d.bgOpacity,1,1):(_.setBgOpacity(1,1,1),_.disableHandles()),bo(E,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function o(){d.shade?k():m(),_.isAwake()&&n(d.bgOpacity)}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(D),right:j().height(D),bottom:j()};return{update:h,updateRaw:i,getShades:p,setBgColor:l,enable:k,disable:m,resize:f,refresh:o,opacity:n}}(),_=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(h(b));return G.append(c),c}function l(b,c){var d=a("<div />").mousedown(q(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return X.support&&d.bind("touchstart.jcrop",X.createDragger(b)),H.append(d),d}function m(a){var b=d.handleSize;return l(a,c++).css({opacity:d.handleOpacity
}).width(b).height(b).addClass(h("handle"))}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function o(a){var b;for(b=0;b<a.length;b++)i[a[b]]=n(a[b])}function p(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}function r(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}function t(a,b){d.shade||F.css({top:g(-b),left:g(-a)}),I.css({top:g(b),left:g(a)})}function u(a,b){I.width(Math.round(a)).height(Math.round(b))}function v(){var a=Y.getFixed();Y.setPressed([a.x,a.y]),Y.setCurrent([a.x2,a.y2]),x()}function x(a){if(b)return y(a)}function y(a){var c=Y.getFixed();u(c.w,c.h),t(c.x,c.y),d.shade&&Z.updateRaw(c),b||A(),a?d.onSelect.call(bq,s(c)):d.onChange.call(bq,s(c))}function z(a,c,e){if(!b&&!c)return;d.bgFade&&!e?B.animate({opacity:a},{queue:!1,duration:d.fadeTime}):B.css("opacity",a)}function A(){I.show(),d.shade?Z.opacity(M):z(M,!0),b=!0}function C(){J(),I.hide(),d.shade?Z.opacity(1):z(1),b=!1
,d.onRelease.call(bq)}function D(){j&&H.show()}function E(){j=!0;if(d.allowResize)return H.show(),!0}function J(){j=!1,H.hide()}function K(a){a?(V=!0,J()):(V=!1,E())}function L(){K(!1),v()}var b,c=370,e={},f={},i={},j=!1;d.dragEdges&&a.isArray(d.createDragbars)&&o(d.createDragbars),a.isArray(d.createHandles)&&r(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&p(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var N=w().mousedown(q("move")).css({cursor:"move",position:"absolute",zIndex:360});return X.support&&N.bind("touchstart.jcrop",X.createDragger("move")),G.append(N),J(),{updateVisible:x,update:y,release:C,refresh:v,isAwake:function(){return b},setCursor:function(a){N.css("cursor",a)},enableHandles:E,enableOnly:function(){j=!0},showHandles:D,disableHandles:J,animMode:K,setBgOpacity:z,done:L}}(),ba=function(){function f(b){K.css({zIndex:450}),b?a(document).bind("touchmove.jcrop",l).bind("touchend.jcrop",m):e&&a
(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){K.css({zIndex:290}),a(document).unbind(".jcrop")}function h(a){return b(k(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),U&&(U=!1,c(k(a)),_.isAwake()&&d.onSelect.call(bq,s(Y.getFixed())),g(),b=function(){},c=function(){}),!1}function j(a,d,e){return U=!0,b=a,c=d,f(e),!1}function l(a){return b(k(X.cfilter(a))),!1}function m(a){return i(X.cfilter(a))}function n(a){K.css("cursor",a)}var b=function(){},c=function(){},e=d.trackDocument;return e||K.mousemove(h).mouseup(i).mouseout(i),B.before(K),{activateHandlers:j,setCursor:n}}(),bb=function(){function e(){d.keySupport&&(b.show(),b.focus())}function f(a){b.hide()}function g(a,b,c){d.allowMove&&(Y.moveOffset([b,c]),_.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}function h(a){if(a.ctrlKey||a.metaKey)return!0;W=a.shiftKey?!0:!1;var b=W?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;case 40:g(a,0,b);break;case 27:d.allowSelect&&
_.release();break;case 9:return!0}return!1}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(h).blur(f),ie6mode||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(B)):b.insertBefore(B)),{watchKeys:e}}();X.support&&K.bind("touchstart.jcrop",X.newSelection),H.hide(),bp(!0);var bq={setImage:bn,animateTo:bd,setSelect:be,setOptions:bi,tellSelect:bg,tellScaled:bh,setClass:bc,disable:bj,enable:bk,cancel:bl,release:_.release,destroy:bm,focus:bb.watchKeys,getBounds:function(){return[C*R,D*S]},getWidgetSize:function(){return[C,D]},getScaleFactor:function(){return[R,S]},getOptions:function(){return d},ui:{holder:E,selection:I}};return is_msie&&E.bind("selectstart",function(){return!1}),y.data("Jcrop",bq),bq},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if(b==="api")return a(this).data("Jcrop"
);a(this).data("Jcrop").setOptions(b)}else this.tagName=="IMG"?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}var e=a(b),f=e[0];e.bind("load.jcloader",g).bind("error.jcloader",function(b){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:7,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade
:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);